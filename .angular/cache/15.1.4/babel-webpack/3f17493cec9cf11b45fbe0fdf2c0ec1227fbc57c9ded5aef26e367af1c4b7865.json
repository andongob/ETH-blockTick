{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.thirdparty = exports.hdkey = void 0;\nvar crypto = __importStar(require(\"crypto\"));\nvar ethereumjs_util_1 = require(\"ethereumjs-util\");\nvar scrypt_js_1 = require(\"scrypt-js\");\nvar hdkey_1 = require(\"./hdkey\");\nObject.defineProperty(exports, \"hdkey\", {\n  enumerable: true,\n  get: function () {\n    return __importDefault(hdkey_1).default;\n  }\n});\nvar thirdparty_1 = require(\"./thirdparty\");\nObject.defineProperty(exports, \"thirdparty\", {\n  enumerable: true,\n  get: function () {\n    return __importDefault(thirdparty_1).default;\n  }\n});\nvar bs58check = require('bs58check');\nvar randomBytes = require('randombytes');\nvar uuidv4 = require('uuid').v4;\nfunction validateHexString(paramName, str, length) {\n  if (str.toLowerCase().startsWith('0x')) {\n    str = str.slice(2);\n  }\n  if (!str && !length) {\n    return str;\n  }\n  if (length % 2) {\n    throw new Error(\"Invalid length argument, must be an even number\");\n  }\n  if (typeof length === 'number' && str.length !== length) {\n    throw new Error(\"Invalid \" + paramName + \", string must be \" + length + \" hex characters\");\n  }\n  if (!/^([0-9a-f]{2})+$/i.test(str)) {\n    var howMany = typeof length === 'number' ? length : 'empty or a non-zero even number of';\n    throw new Error(\"Invalid \" + paramName + \", string must be \" + howMany + \" hex characters\");\n  }\n  return str;\n}\nfunction validateBuffer(paramName, buff, length) {\n  if (!Buffer.isBuffer(buff)) {\n    var howManyHex = typeof length === 'number' ? \"\" + length * 2 : 'empty or a non-zero even number of';\n    var howManyBytes = typeof length === 'number' ? \" (\" + length + \" bytes)\" : '';\n    throw new Error(\"Invalid \" + paramName + \", must be a string (\" + howManyHex + \" hex characters) or buffer\" + howManyBytes);\n  }\n  if (typeof length === 'number' && buff.length !== length) {\n    throw new Error(\"Invalid \" + paramName + \", buffer must be \" + length + \" bytes\");\n  }\n  return buff;\n}\nfunction mergeToV3ParamsWithDefaults(params) {\n  var v3Defaults = {\n    cipher: 'aes-128-ctr',\n    kdf: 'scrypt',\n    salt: randomBytes(32),\n    iv: randomBytes(16),\n    uuid: randomBytes(16),\n    dklen: 32,\n    c: 262144,\n    n: 262144,\n    r: 8,\n    p: 1\n  };\n  if (!params) {\n    return v3Defaults;\n  }\n  if (typeof params.salt === 'string') {\n    params.salt = Buffer.from(validateHexString('salt', params.salt), 'hex');\n  }\n  if (typeof params.iv === 'string') {\n    params.iv = Buffer.from(validateHexString('iv', params.iv, 32), 'hex');\n  }\n  if (typeof params.uuid === 'string') {\n    params.uuid = Buffer.from(validateHexString('uuid', params.uuid, 32), 'hex');\n  }\n  if (params.salt) {\n    validateBuffer('salt', params.salt);\n  }\n  if (params.iv) {\n    validateBuffer('iv', params.iv, 16);\n  }\n  if (params.uuid) {\n    validateBuffer('uuid', params.uuid, 16);\n  }\n  return __assign(__assign({}, v3Defaults), params);\n}\nfunction kdfParamsForPBKDF(opts) {\n  return {\n    dklen: opts.dklen,\n    salt: opts.salt,\n    c: opts.c,\n    prf: 'hmac-sha256'\n  };\n}\nfunction kdfParamsForScrypt(opts) {\n  return {\n    dklen: opts.dklen,\n    salt: opts.salt,\n    n: opts.n,\n    r: opts.r,\n    p: opts.p\n  };\n}\n// wallet implementation\nvar Wallet = /** @class */function () {\n  function Wallet(privateKey, publicKey) {\n    if (publicKey === void 0) {\n      publicKey = undefined;\n    }\n    this.privateKey = privateKey;\n    this.publicKey = publicKey;\n    if (privateKey && publicKey) {\n      throw new Error('Cannot supply both a private and a public key to the constructor');\n    }\n    if (privateKey && !(0, ethereumjs_util_1.isValidPrivate)(privateKey)) {\n      throw new Error('Private key does not satisfy the curve requirements (ie. it is invalid)');\n    }\n    if (publicKey && !(0, ethereumjs_util_1.isValidPublic)(publicKey)) {\n      throw new Error('Invalid public key');\n    }\n  }\n  // static methods\n  /**\n   * Create an instance based on a new random key.\n   *\n   * @param icapDirect setting this to `true` will generate an address suitable for the `ICAP Direct mode`\n   */\n  Wallet.generate = function (icapDirect) {\n    if (icapDirect === void 0) {\n      icapDirect = false;\n    }\n    if (icapDirect) {\n      var max = new ethereumjs_util_1.BN('088f924eeceeda7fe92e1f5b0fffffffffffffff', 16);\n      while (true) {\n        var privateKey = randomBytes(32);\n        if (new ethereumjs_util_1.BN((0, ethereumjs_util_1.privateToAddress)(privateKey)).lte(max)) {\n          return new Wallet(privateKey);\n        }\n      }\n    } else {\n      return new Wallet(randomBytes(32));\n    }\n  };\n  /**\n   * Create an instance where the address is valid against the supplied pattern (**this will be very slow**)\n   */\n  Wallet.generateVanityAddress = function (pattern) {\n    if (!(pattern instanceof RegExp)) {\n      pattern = new RegExp(pattern);\n    }\n    while (true) {\n      var privateKey = randomBytes(32);\n      var address = (0, ethereumjs_util_1.privateToAddress)(privateKey);\n      if (pattern.test(address.toString('hex'))) {\n        return new Wallet(privateKey);\n      }\n    }\n  };\n  /**\n   * Create an instance based on a public key (certain methods will not be available)\n   *\n   * This method only accepts uncompressed Ethereum-style public keys, unless\n   * the `nonStrict` flag is set to true.\n   */\n  Wallet.fromPublicKey = function (publicKey, nonStrict) {\n    if (nonStrict === void 0) {\n      nonStrict = false;\n    }\n    if (nonStrict) {\n      publicKey = (0, ethereumjs_util_1.importPublic)(publicKey);\n    }\n    return new Wallet(undefined, publicKey);\n  };\n  /**\n   * Create an instance based on a BIP32 extended public key (xpub)\n   */\n  Wallet.fromExtendedPublicKey = function (extendedPublicKey) {\n    if (extendedPublicKey.slice(0, 4) !== 'xpub') {\n      throw new Error('Not an extended public key');\n    }\n    var publicKey = bs58check.decode(extendedPublicKey).slice(45);\n    // Convert to an Ethereum public key\n    return Wallet.fromPublicKey(publicKey, true);\n  };\n  /**\n   * Create an instance based on a raw private key\n   */\n  Wallet.fromPrivateKey = function (privateKey) {\n    return new Wallet(privateKey);\n  };\n  /**\n   * Create an instance based on a BIP32 extended private key (xprv)\n   */\n  Wallet.fromExtendedPrivateKey = function (extendedPrivateKey) {\n    if (extendedPrivateKey.slice(0, 4) !== 'xprv') {\n      throw new Error('Not an extended private key');\n    }\n    var tmp = bs58check.decode(extendedPrivateKey);\n    if (tmp[45] !== 0) {\n      throw new Error('Invalid extended private key');\n    }\n    return Wallet.fromPrivateKey(tmp.slice(46));\n  };\n  /**\n   * Import a wallet (Version 1 of the Ethereum wallet format).\n   *\n   * @param input A JSON serialized string, or an object representing V1 Keystore.\n   * @param password The keystore password.\n   */\n  Wallet.fromV1 = function (input, password) {\n    return __awaiter(this, void 0, void 0, function () {\n      var json, kdfparams, derivedKey, ciphertext, mac, decipher, seed;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            json = typeof input === 'object' ? input : JSON.parse(input);\n            if (json.Version !== '1') {\n              throw new Error('Not a V1 Wallet');\n            }\n            if (json.Crypto.KeyHeader.Kdf !== 'scrypt') {\n              throw new Error('Unsupported key derivation scheme');\n            }\n            kdfparams = json.Crypto.KeyHeader.KdfParams;\n            return [4 /*yield*/, (0, scrypt_js_1.scrypt)(Buffer.from(password), Buffer.from(json.Crypto.Salt, 'hex'), kdfparams.N, kdfparams.R, kdfparams.P, kdfparams.DkLen)];\n          case 1:\n            derivedKey = _a.sent();\n            ciphertext = Buffer.from(json.Crypto.CipherText, 'hex');\n            mac = (0, ethereumjs_util_1.keccak256)(Buffer.concat([derivedKey.slice(16, 32), ciphertext]));\n            if (mac.toString('hex') !== json.Crypto.MAC) {\n              throw new Error('Key derivation failed - possibly wrong passphrase');\n            }\n            decipher = crypto.createDecipheriv('aes-128-cbc', (0, ethereumjs_util_1.keccak256)(derivedKey.slice(0, 16)).slice(0, 16), Buffer.from(json.Crypto.IV, 'hex'));\n            seed = runCipherBuffer(decipher, ciphertext);\n            return [2 /*return*/, new Wallet(seed)];\n        }\n      });\n    });\n  };\n  /**\n   * Import a wallet (Version 3 of the Ethereum wallet format). Set `nonStrict` true to accept files with mixed-caps.\n   *\n   * @param input A JSON serialized string, or an object representing V3 Keystore.\n   * @param password The keystore password.\n   */\n  Wallet.fromV3 = function (input, password, nonStrict) {\n    if (nonStrict === void 0) {\n      nonStrict = false;\n    }\n    return __awaiter(this, void 0, void 0, function () {\n      var json, derivedKey, kdfparams, ciphertext, mac, decipher, seed;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            json = typeof input === 'object' ? input : JSON.parse(nonStrict ? input.toLowerCase() : input);\n            if (json.version !== 3) {\n              throw new Error('Not a V3 wallet');\n            }\n            if (!(json.crypto.kdf === 'scrypt')) return [3 /*break*/, 2];\n            kdfparams = json.crypto.kdfparams;\n            return [4 /*yield*/, (0, scrypt_js_1.scrypt)(Buffer.from(password), Buffer.from(kdfparams.salt, 'hex'), kdfparams.n, kdfparams.r, kdfparams.p, kdfparams.dklen)];\n          case 1:\n            // FIXME: support progress reporting callback\n            derivedKey = _a.sent();\n            return [3 /*break*/, 3];\n          case 2:\n            if (json.crypto.kdf === 'pbkdf2') {\n              kdfparams = json.crypto.kdfparams;\n              if (kdfparams.prf !== 'hmac-sha256') {\n                throw new Error('Unsupported parameters to PBKDF2');\n              }\n              derivedKey = crypto.pbkdf2Sync(Buffer.from(password), Buffer.from(kdfparams.salt, 'hex'), kdfparams.c, kdfparams.dklen, 'sha256');\n            } else {\n              throw new Error('Unsupported key derivation scheme');\n            }\n            _a.label = 3;\n          case 3:\n            ciphertext = Buffer.from(json.crypto.ciphertext, 'hex');\n            mac = (0, ethereumjs_util_1.keccak256)(Buffer.concat([Buffer.from(derivedKey.slice(16, 32)), ciphertext]));\n            if (mac.toString('hex') !== json.crypto.mac) {\n              throw new Error('Key derivation failed - possibly wrong passphrase');\n            }\n            decipher = crypto.createDecipheriv(json.crypto.cipher, derivedKey.slice(0, 16), Buffer.from(json.crypto.cipherparams.iv, 'hex'));\n            seed = runCipherBuffer(decipher, ciphertext);\n            return [2 /*return*/, new Wallet(seed)];\n        }\n      });\n    });\n  };\n  /*\n   * Import an Ethereum Pre Sale wallet.\n   * Based on https://github.com/ethereum/pyethsaletool/blob/master/pyethsaletool.py\n   * JSON fields: encseed, ethaddr, btcaddr, email\n   *\n   * @param input A JSON serialized string, or an object representing EthSale Keystore.\n   * @param password The keystore password.\n   */\n  Wallet.fromEthSale = function (input, password) {\n    var json = typeof input === 'object' ? input : JSON.parse(input);\n    var encseed = Buffer.from(json.encseed, 'hex');\n    // key derivation\n    var derivedKey = crypto.pbkdf2Sync(password, password, 2000, 32, 'sha256').slice(0, 16);\n    // seed decoding (IV is first 16 bytes)\n    // NOTE: crypto (derived from openssl) when used with aes-*-cbc will handle PKCS#7 padding internally\n    //       see also http://stackoverflow.com/a/31614770/4964819\n    var decipher = crypto.createDecipheriv('aes-128-cbc', derivedKey, encseed.slice(0, 16));\n    var seed = runCipherBuffer(decipher, encseed.slice(16));\n    var wallet = new Wallet((0, ethereumjs_util_1.keccak256)(seed));\n    if (wallet.getAddress().toString('hex') !== json.ethaddr) {\n      throw new Error('Decoded key mismatch - possibly wrong passphrase');\n    }\n    return wallet;\n  };\n  Object.defineProperty(Wallet.prototype, \"pubKey\", {\n    // private getters\n    /**\n     * Returns the wallet's public key.\n     */\n    get: function () {\n      if (!keyExists(this.publicKey)) {\n        this.publicKey = (0, ethereumjs_util_1.privateToPublic)(this.privateKey);\n      }\n      return this.publicKey;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Wallet.prototype, \"privKey\", {\n    /**\n     * Returns the wallet's private key.\n     */\n    get: function () {\n      if (!keyExists(this.privateKey)) {\n        throw new Error('This is a public key only wallet');\n      }\n      return this.privateKey;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  // public instance methods\n  /**\n   * Returns the wallet's private key.\n   *\n   */\n  // tslint:disable-next-line\n  Wallet.prototype.getPrivateKey = function () {\n    return this.privKey;\n  };\n  Wallet.prototype.getPrivateKeyString = function () {\n    return (0, ethereumjs_util_1.bufferToHex)(this.privKey);\n  };\n  /**\n   * Returns the wallet's public key.\n   */\n  // tslint:disable-next-line\n  Wallet.prototype.getPublicKey = function () {\n    return this.pubKey;\n  };\n  /**\n   * Returns the wallet's public key as a \"0x\" prefixed hex string\n   */\n  Wallet.prototype.getPublicKeyString = function () {\n    return (0, ethereumjs_util_1.bufferToHex)(this.getPublicKey());\n  };\n  /**\n   * Returns the wallet's address.\n   */\n  Wallet.prototype.getAddress = function () {\n    return (0, ethereumjs_util_1.publicToAddress)(this.pubKey);\n  };\n  /**\n   * Returns the wallet's address as a \"0x\" prefixed hex string\n   */\n  Wallet.prototype.getAddressString = function () {\n    return (0, ethereumjs_util_1.bufferToHex)(this.getAddress());\n  };\n  /**\n   * Returns the wallet's private key as a \"0x\" prefixed hex string checksummed\n   * according to [EIP 55](https://github.com/ethereum/EIPs/issues/55).\n   */\n  Wallet.prototype.getChecksumAddressString = function () {\n    return (0, ethereumjs_util_1.toChecksumAddress)(this.getAddressString());\n  };\n  /**\n   * Returns an Etherem Version 3 Keystore Format object representing the wallet\n   *\n   * @param password The password used to encrypt the Keystore.\n   * @param opts The options for the keystore. See [its spec](https://github.com/ethereum/wiki/wiki/Web3-Secret-Storage-Definition) for more info.\n   */\n  Wallet.prototype.toV3 = function (password, opts) {\n    return __awaiter(this, void 0, void 0, function () {\n      var v3Params, kdfParams, derivedKey, _a, cipher, ciphertext, mac;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            if (!keyExists(this.privateKey)) {\n              throw new Error('This is a public key only wallet');\n            }\n            v3Params = mergeToV3ParamsWithDefaults(opts);\n            _a = v3Params.kdf;\n            switch (_a) {\n              case \"pbkdf2\" /* PBKDF */:\n                return [3 /*break*/, 1];\n              case \"scrypt\" /* Scrypt */:\n                return [3 /*break*/, 2];\n            }\n            return [3 /*break*/, 4];\n          case 1:\n            kdfParams = kdfParamsForPBKDF(v3Params);\n            derivedKey = crypto.pbkdf2Sync(Buffer.from(password), kdfParams.salt, kdfParams.c, kdfParams.dklen, 'sha256');\n            return [3 /*break*/, 5];\n          case 2:\n            kdfParams = kdfParamsForScrypt(v3Params);\n            return [4 /*yield*/, (0, scrypt_js_1.scrypt)(Buffer.from(password), kdfParams.salt, kdfParams.n, kdfParams.r, kdfParams.p, kdfParams.dklen)];\n          case 3:\n            // FIXME: support progress reporting callback\n            derivedKey = _b.sent();\n            return [3 /*break*/, 5];\n          case 4:\n            throw new Error('Unsupported kdf');\n          case 5:\n            cipher = crypto.createCipheriv(v3Params.cipher, derivedKey.slice(0, 16), v3Params.iv);\n            if (!cipher) {\n              throw new Error('Unsupported cipher');\n            }\n            ciphertext = runCipherBuffer(cipher, this.privKey);\n            mac = (0, ethereumjs_util_1.keccak256)(Buffer.concat([Buffer.from(derivedKey.slice(16, 32)), Buffer.from(ciphertext)]));\n            return [2 /*return*/, {\n              version: 3,\n              id: uuidv4({\n                random: v3Params.uuid\n              }),\n              // @ts-ignore - the official V3 keystore spec omits the address key\n              address: this.getAddress().toString('hex'),\n              crypto: {\n                ciphertext: ciphertext.toString('hex'),\n                cipherparams: {\n                  iv: v3Params.iv.toString('hex')\n                },\n                cipher: v3Params.cipher,\n                kdf: v3Params.kdf,\n                kdfparams: __assign(__assign({}, kdfParams), {\n                  salt: kdfParams.salt.toString('hex')\n                }),\n                mac: mac.toString('hex')\n              }\n            }];\n        }\n      });\n    });\n  };\n  /**\n   * Return the suggested filename for V3 keystores.\n   */\n  Wallet.prototype.getV3Filename = function (timestamp) {\n    /*\n     * We want a timestamp like 2016-03-15T17-11-33.007598288Z. Date formatting\n     * is a pain in Javascript, everbody knows that. We could use moment.js,\n     * but decide to do it manually in order to save space.\n     *\n     * toJSON() returns a pretty close version, so let's use it. It is not UTC though,\n     * but does it really matter?\n     *\n     * Alternative manual way with padding and Date fields: http://stackoverflow.com/a/7244288/4964819\n     *\n     */\n    var ts = timestamp ? new Date(timestamp) : new Date();\n    return ['UTC--', ts.toJSON().replace(/:/g, '-'), '--', this.getAddress().toString('hex')].join('');\n  };\n  Wallet.prototype.toV3String = function (password, opts) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, _b;\n      return __generator(this, function (_c) {\n        switch (_c.label) {\n          case 0:\n            _b = (_a = JSON).stringify;\n            return [4 /*yield*/, this.toV3(password, opts)];\n          case 1:\n            return [2 /*return*/, _b.apply(_a, [_c.sent()])];\n        }\n      });\n    });\n  };\n  return Wallet;\n}();\nexports.default = Wallet;\n// helpers\nfunction runCipherBuffer(cipher, data) {\n  return Buffer.concat([cipher.update(data), cipher.final()]);\n}\nfunction keyExists(k) {\n  return k !== undefined && k !== null;\n}","map":{"version":3,"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__createBinding","create","o","m","k","k2","undefined","defineProperty","enumerable","get","__setModuleDefault","v","value","__importStar","mod","__esModule","result","__awaiter","thisArg","_arguments","P","generator","adopt","resolve","Promise","reject","fulfilled","step","next","e","rejected","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","Symbol","iterator","op","TypeError","pop","push","__importDefault","exports","thirdparty","hdkey","crypto","require","ethereumjs_util_1","scrypt_js_1","hdkey_1","default","thirdparty_1","bs58check","randomBytes","uuidv4","v4","validateHexString","paramName","str","toLowerCase","startsWith","slice","Error","test","howMany","validateBuffer","buff","Buffer","isBuffer","howManyHex","howManyBytes","mergeToV3ParamsWithDefaults","params","v3Defaults","cipher","kdf","salt","iv","uuid","dklen","c","r","from","kdfParamsForPBKDF","opts","prf","kdfParamsForScrypt","Wallet","privateKey","publicKey","isValidPrivate","isValidPublic","generate","icapDirect","max","BN","privateToAddress","lte","generateVanityAddress","pattern","RegExp","address","toString","fromPublicKey","nonStrict","importPublic","fromExtendedPublicKey","extendedPublicKey","decode","fromPrivateKey","fromExtendedPrivateKey","extendedPrivateKey","tmp","fromV1","input","password","json","kdfparams","derivedKey","ciphertext","mac","decipher","seed","_a","JSON","parse","Version","Crypto","KeyHeader","Kdf","KdfParams","scrypt","Salt","N","R","DkLen","CipherText","keccak256","concat","MAC","createDecipheriv","IV","runCipherBuffer","fromV3","version","pbkdf2Sync","cipherparams","fromEthSale","encseed","wallet","getAddress","ethaddr","keyExists","privateToPublic","configurable","getPrivateKey","privKey","getPrivateKeyString","bufferToHex","getPublicKey","pubKey","getPublicKeyString","publicToAddress","getAddressString","getChecksumAddressString","toChecksumAddress","toV3","v3Params","kdfParams","_b","createCipheriv","id","random","getV3Filename","timestamp","ts","Date","toJSON","replace","join","toV3String","_c","stringify","data","update","final"],"sources":["D:/Documentos/BLOCKCHAIN/Doble Grado BlockChain/Blockchain Engineering/TFG - Enginering/BLOCKTICK/blocktick_dApp/node_modules/ethereumjs-wallet/dist.browser/index.js"],"sourcesContent":["\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.thirdparty = exports.hdkey = void 0;\nvar crypto = __importStar(require(\"crypto\"));\nvar ethereumjs_util_1 = require(\"ethereumjs-util\");\nvar scrypt_js_1 = require(\"scrypt-js\");\nvar hdkey_1 = require(\"./hdkey\");\nObject.defineProperty(exports, \"hdkey\", { enumerable: true, get: function () { return __importDefault(hdkey_1).default; } });\nvar thirdparty_1 = require(\"./thirdparty\");\nObject.defineProperty(exports, \"thirdparty\", { enumerable: true, get: function () { return __importDefault(thirdparty_1).default; } });\nvar bs58check = require('bs58check');\nvar randomBytes = require('randombytes');\nvar uuidv4 = require('uuid').v4;\nfunction validateHexString(paramName, str, length) {\n    if (str.toLowerCase().startsWith('0x')) {\n        str = str.slice(2);\n    }\n    if (!str && !length) {\n        return str;\n    }\n    if (length % 2) {\n        throw new Error(\"Invalid length argument, must be an even number\");\n    }\n    if (typeof length === 'number' && str.length !== length) {\n        throw new Error(\"Invalid \" + paramName + \", string must be \" + length + \" hex characters\");\n    }\n    if (!/^([0-9a-f]{2})+$/i.test(str)) {\n        var howMany = typeof length === 'number' ? length : 'empty or a non-zero even number of';\n        throw new Error(\"Invalid \" + paramName + \", string must be \" + howMany + \" hex characters\");\n    }\n    return str;\n}\nfunction validateBuffer(paramName, buff, length) {\n    if (!Buffer.isBuffer(buff)) {\n        var howManyHex = typeof length === 'number' ? \"\" + length * 2 : 'empty or a non-zero even number of';\n        var howManyBytes = typeof length === 'number' ? \" (\" + length + \" bytes)\" : '';\n        throw new Error(\"Invalid \" + paramName + \", must be a string (\" + howManyHex + \" hex characters) or buffer\" + howManyBytes);\n    }\n    if (typeof length === 'number' && buff.length !== length) {\n        throw new Error(\"Invalid \" + paramName + \", buffer must be \" + length + \" bytes\");\n    }\n    return buff;\n}\nfunction mergeToV3ParamsWithDefaults(params) {\n    var v3Defaults = {\n        cipher: 'aes-128-ctr',\n        kdf: 'scrypt',\n        salt: randomBytes(32),\n        iv: randomBytes(16),\n        uuid: randomBytes(16),\n        dklen: 32,\n        c: 262144,\n        n: 262144,\n        r: 8,\n        p: 1,\n    };\n    if (!params) {\n        return v3Defaults;\n    }\n    if (typeof params.salt === 'string') {\n        params.salt = Buffer.from(validateHexString('salt', params.salt), 'hex');\n    }\n    if (typeof params.iv === 'string') {\n        params.iv = Buffer.from(validateHexString('iv', params.iv, 32), 'hex');\n    }\n    if (typeof params.uuid === 'string') {\n        params.uuid = Buffer.from(validateHexString('uuid', params.uuid, 32), 'hex');\n    }\n    if (params.salt) {\n        validateBuffer('salt', params.salt);\n    }\n    if (params.iv) {\n        validateBuffer('iv', params.iv, 16);\n    }\n    if (params.uuid) {\n        validateBuffer('uuid', params.uuid, 16);\n    }\n    return __assign(__assign({}, v3Defaults), params);\n}\nfunction kdfParamsForPBKDF(opts) {\n    return {\n        dklen: opts.dklen,\n        salt: opts.salt,\n        c: opts.c,\n        prf: 'hmac-sha256',\n    };\n}\nfunction kdfParamsForScrypt(opts) {\n    return {\n        dklen: opts.dklen,\n        salt: opts.salt,\n        n: opts.n,\n        r: opts.r,\n        p: opts.p,\n    };\n}\n// wallet implementation\nvar Wallet = /** @class */ (function () {\n    function Wallet(privateKey, publicKey) {\n        if (publicKey === void 0) { publicKey = undefined; }\n        this.privateKey = privateKey;\n        this.publicKey = publicKey;\n        if (privateKey && publicKey) {\n            throw new Error('Cannot supply both a private and a public key to the constructor');\n        }\n        if (privateKey && !(0, ethereumjs_util_1.isValidPrivate)(privateKey)) {\n            throw new Error('Private key does not satisfy the curve requirements (ie. it is invalid)');\n        }\n        if (publicKey && !(0, ethereumjs_util_1.isValidPublic)(publicKey)) {\n            throw new Error('Invalid public key');\n        }\n    }\n    // static methods\n    /**\n     * Create an instance based on a new random key.\n     *\n     * @param icapDirect setting this to `true` will generate an address suitable for the `ICAP Direct mode`\n     */\n    Wallet.generate = function (icapDirect) {\n        if (icapDirect === void 0) { icapDirect = false; }\n        if (icapDirect) {\n            var max = new ethereumjs_util_1.BN('088f924eeceeda7fe92e1f5b0fffffffffffffff', 16);\n            while (true) {\n                var privateKey = randomBytes(32);\n                if (new ethereumjs_util_1.BN((0, ethereumjs_util_1.privateToAddress)(privateKey)).lte(max)) {\n                    return new Wallet(privateKey);\n                }\n            }\n        }\n        else {\n            return new Wallet(randomBytes(32));\n        }\n    };\n    /**\n     * Create an instance where the address is valid against the supplied pattern (**this will be very slow**)\n     */\n    Wallet.generateVanityAddress = function (pattern) {\n        if (!(pattern instanceof RegExp)) {\n            pattern = new RegExp(pattern);\n        }\n        while (true) {\n            var privateKey = randomBytes(32);\n            var address = (0, ethereumjs_util_1.privateToAddress)(privateKey);\n            if (pattern.test(address.toString('hex'))) {\n                return new Wallet(privateKey);\n            }\n        }\n    };\n    /**\n     * Create an instance based on a public key (certain methods will not be available)\n     *\n     * This method only accepts uncompressed Ethereum-style public keys, unless\n     * the `nonStrict` flag is set to true.\n     */\n    Wallet.fromPublicKey = function (publicKey, nonStrict) {\n        if (nonStrict === void 0) { nonStrict = false; }\n        if (nonStrict) {\n            publicKey = (0, ethereumjs_util_1.importPublic)(publicKey);\n        }\n        return new Wallet(undefined, publicKey);\n    };\n    /**\n     * Create an instance based on a BIP32 extended public key (xpub)\n     */\n    Wallet.fromExtendedPublicKey = function (extendedPublicKey) {\n        if (extendedPublicKey.slice(0, 4) !== 'xpub') {\n            throw new Error('Not an extended public key');\n        }\n        var publicKey = bs58check.decode(extendedPublicKey).slice(45);\n        // Convert to an Ethereum public key\n        return Wallet.fromPublicKey(publicKey, true);\n    };\n    /**\n     * Create an instance based on a raw private key\n     */\n    Wallet.fromPrivateKey = function (privateKey) {\n        return new Wallet(privateKey);\n    };\n    /**\n     * Create an instance based on a BIP32 extended private key (xprv)\n     */\n    Wallet.fromExtendedPrivateKey = function (extendedPrivateKey) {\n        if (extendedPrivateKey.slice(0, 4) !== 'xprv') {\n            throw new Error('Not an extended private key');\n        }\n        var tmp = bs58check.decode(extendedPrivateKey);\n        if (tmp[45] !== 0) {\n            throw new Error('Invalid extended private key');\n        }\n        return Wallet.fromPrivateKey(tmp.slice(46));\n    };\n    /**\n     * Import a wallet (Version 1 of the Ethereum wallet format).\n     *\n     * @param input A JSON serialized string, or an object representing V1 Keystore.\n     * @param password The keystore password.\n     */\n    Wallet.fromV1 = function (input, password) {\n        return __awaiter(this, void 0, void 0, function () {\n            var json, kdfparams, derivedKey, ciphertext, mac, decipher, seed;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        json = typeof input === 'object' ? input : JSON.parse(input);\n                        if (json.Version !== '1') {\n                            throw new Error('Not a V1 Wallet');\n                        }\n                        if (json.Crypto.KeyHeader.Kdf !== 'scrypt') {\n                            throw new Error('Unsupported key derivation scheme');\n                        }\n                        kdfparams = json.Crypto.KeyHeader.KdfParams;\n                        return [4 /*yield*/, (0, scrypt_js_1.scrypt)(Buffer.from(password), Buffer.from(json.Crypto.Salt, 'hex'), kdfparams.N, kdfparams.R, kdfparams.P, kdfparams.DkLen)];\n                    case 1:\n                        derivedKey = _a.sent();\n                        ciphertext = Buffer.from(json.Crypto.CipherText, 'hex');\n                        mac = (0, ethereumjs_util_1.keccak256)(Buffer.concat([derivedKey.slice(16, 32), ciphertext]));\n                        if (mac.toString('hex') !== json.Crypto.MAC) {\n                            throw new Error('Key derivation failed - possibly wrong passphrase');\n                        }\n                        decipher = crypto.createDecipheriv('aes-128-cbc', (0, ethereumjs_util_1.keccak256)(derivedKey.slice(0, 16)).slice(0, 16), Buffer.from(json.Crypto.IV, 'hex'));\n                        seed = runCipherBuffer(decipher, ciphertext);\n                        return [2 /*return*/, new Wallet(seed)];\n                }\n            });\n        });\n    };\n    /**\n     * Import a wallet (Version 3 of the Ethereum wallet format). Set `nonStrict` true to accept files with mixed-caps.\n     *\n     * @param input A JSON serialized string, or an object representing V3 Keystore.\n     * @param password The keystore password.\n     */\n    Wallet.fromV3 = function (input, password, nonStrict) {\n        if (nonStrict === void 0) { nonStrict = false; }\n        return __awaiter(this, void 0, void 0, function () {\n            var json, derivedKey, kdfparams, ciphertext, mac, decipher, seed;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        json = typeof input === 'object' ? input : JSON.parse(nonStrict ? input.toLowerCase() : input);\n                        if (json.version !== 3) {\n                            throw new Error('Not a V3 wallet');\n                        }\n                        if (!(json.crypto.kdf === 'scrypt')) return [3 /*break*/, 2];\n                        kdfparams = json.crypto.kdfparams;\n                        return [4 /*yield*/, (0, scrypt_js_1.scrypt)(Buffer.from(password), Buffer.from(kdfparams.salt, 'hex'), kdfparams.n, kdfparams.r, kdfparams.p, kdfparams.dklen)];\n                    case 1:\n                        // FIXME: support progress reporting callback\n                        derivedKey = _a.sent();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        if (json.crypto.kdf === 'pbkdf2') {\n                            kdfparams = json.crypto.kdfparams;\n                            if (kdfparams.prf !== 'hmac-sha256') {\n                                throw new Error('Unsupported parameters to PBKDF2');\n                            }\n                            derivedKey = crypto.pbkdf2Sync(Buffer.from(password), Buffer.from(kdfparams.salt, 'hex'), kdfparams.c, kdfparams.dklen, 'sha256');\n                        }\n                        else {\n                            throw new Error('Unsupported key derivation scheme');\n                        }\n                        _a.label = 3;\n                    case 3:\n                        ciphertext = Buffer.from(json.crypto.ciphertext, 'hex');\n                        mac = (0, ethereumjs_util_1.keccak256)(Buffer.concat([Buffer.from(derivedKey.slice(16, 32)), ciphertext]));\n                        if (mac.toString('hex') !== json.crypto.mac) {\n                            throw new Error('Key derivation failed - possibly wrong passphrase');\n                        }\n                        decipher = crypto.createDecipheriv(json.crypto.cipher, derivedKey.slice(0, 16), Buffer.from(json.crypto.cipherparams.iv, 'hex'));\n                        seed = runCipherBuffer(decipher, ciphertext);\n                        return [2 /*return*/, new Wallet(seed)];\n                }\n            });\n        });\n    };\n    /*\n     * Import an Ethereum Pre Sale wallet.\n     * Based on https://github.com/ethereum/pyethsaletool/blob/master/pyethsaletool.py\n     * JSON fields: encseed, ethaddr, btcaddr, email\n     *\n     * @param input A JSON serialized string, or an object representing EthSale Keystore.\n     * @param password The keystore password.\n     */\n    Wallet.fromEthSale = function (input, password) {\n        var json = typeof input === 'object' ? input : JSON.parse(input);\n        var encseed = Buffer.from(json.encseed, 'hex');\n        // key derivation\n        var derivedKey = crypto.pbkdf2Sync(password, password, 2000, 32, 'sha256').slice(0, 16);\n        // seed decoding (IV is first 16 bytes)\n        // NOTE: crypto (derived from openssl) when used with aes-*-cbc will handle PKCS#7 padding internally\n        //       see also http://stackoverflow.com/a/31614770/4964819\n        var decipher = crypto.createDecipheriv('aes-128-cbc', derivedKey, encseed.slice(0, 16));\n        var seed = runCipherBuffer(decipher, encseed.slice(16));\n        var wallet = new Wallet((0, ethereumjs_util_1.keccak256)(seed));\n        if (wallet.getAddress().toString('hex') !== json.ethaddr) {\n            throw new Error('Decoded key mismatch - possibly wrong passphrase');\n        }\n        return wallet;\n    };\n    Object.defineProperty(Wallet.prototype, \"pubKey\", {\n        // private getters\n        /**\n         * Returns the wallet's public key.\n         */\n        get: function () {\n            if (!keyExists(this.publicKey)) {\n                this.publicKey = (0, ethereumjs_util_1.privateToPublic)(this.privateKey);\n            }\n            return this.publicKey;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Wallet.prototype, \"privKey\", {\n        /**\n         * Returns the wallet's private key.\n         */\n        get: function () {\n            if (!keyExists(this.privateKey)) {\n                throw new Error('This is a public key only wallet');\n            }\n            return this.privateKey;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    // public instance methods\n    /**\n     * Returns the wallet's private key.\n     *\n     */\n    // tslint:disable-next-line\n    Wallet.prototype.getPrivateKey = function () {\n        return this.privKey;\n    };\n    Wallet.prototype.getPrivateKeyString = function () {\n        return (0, ethereumjs_util_1.bufferToHex)(this.privKey);\n    };\n    /**\n     * Returns the wallet's public key.\n     */\n    // tslint:disable-next-line\n    Wallet.prototype.getPublicKey = function () {\n        return this.pubKey;\n    };\n    /**\n     * Returns the wallet's public key as a \"0x\" prefixed hex string\n     */\n    Wallet.prototype.getPublicKeyString = function () {\n        return (0, ethereumjs_util_1.bufferToHex)(this.getPublicKey());\n    };\n    /**\n     * Returns the wallet's address.\n     */\n    Wallet.prototype.getAddress = function () {\n        return (0, ethereumjs_util_1.publicToAddress)(this.pubKey);\n    };\n    /**\n     * Returns the wallet's address as a \"0x\" prefixed hex string\n     */\n    Wallet.prototype.getAddressString = function () {\n        return (0, ethereumjs_util_1.bufferToHex)(this.getAddress());\n    };\n    /**\n     * Returns the wallet's private key as a \"0x\" prefixed hex string checksummed\n     * according to [EIP 55](https://github.com/ethereum/EIPs/issues/55).\n     */\n    Wallet.prototype.getChecksumAddressString = function () {\n        return (0, ethereumjs_util_1.toChecksumAddress)(this.getAddressString());\n    };\n    /**\n     * Returns an Etherem Version 3 Keystore Format object representing the wallet\n     *\n     * @param password The password used to encrypt the Keystore.\n     * @param opts The options for the keystore. See [its spec](https://github.com/ethereum/wiki/wiki/Web3-Secret-Storage-Definition) for more info.\n     */\n    Wallet.prototype.toV3 = function (password, opts) {\n        return __awaiter(this, void 0, void 0, function () {\n            var v3Params, kdfParams, derivedKey, _a, cipher, ciphertext, mac;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (!keyExists(this.privateKey)) {\n                            throw new Error('This is a public key only wallet');\n                        }\n                        v3Params = mergeToV3ParamsWithDefaults(opts);\n                        _a = v3Params.kdf;\n                        switch (_a) {\n                            case \"pbkdf2\" /* PBKDF */: return [3 /*break*/, 1];\n                            case \"scrypt\" /* Scrypt */: return [3 /*break*/, 2];\n                        }\n                        return [3 /*break*/, 4];\n                    case 1:\n                        kdfParams = kdfParamsForPBKDF(v3Params);\n                        derivedKey = crypto.pbkdf2Sync(Buffer.from(password), kdfParams.salt, kdfParams.c, kdfParams.dklen, 'sha256');\n                        return [3 /*break*/, 5];\n                    case 2:\n                        kdfParams = kdfParamsForScrypt(v3Params);\n                        return [4 /*yield*/, (0, scrypt_js_1.scrypt)(Buffer.from(password), kdfParams.salt, kdfParams.n, kdfParams.r, kdfParams.p, kdfParams.dklen)];\n                    case 3:\n                        // FIXME: support progress reporting callback\n                        derivedKey = _b.sent();\n                        return [3 /*break*/, 5];\n                    case 4: throw new Error('Unsupported kdf');\n                    case 5:\n                        cipher = crypto.createCipheriv(v3Params.cipher, derivedKey.slice(0, 16), v3Params.iv);\n                        if (!cipher) {\n                            throw new Error('Unsupported cipher');\n                        }\n                        ciphertext = runCipherBuffer(cipher, this.privKey);\n                        mac = (0, ethereumjs_util_1.keccak256)(Buffer.concat([Buffer.from(derivedKey.slice(16, 32)), Buffer.from(ciphertext)]));\n                        return [2 /*return*/, {\n                                version: 3,\n                                id: uuidv4({ random: v3Params.uuid }),\n                                // @ts-ignore - the official V3 keystore spec omits the address key\n                                address: this.getAddress().toString('hex'),\n                                crypto: {\n                                    ciphertext: ciphertext.toString('hex'),\n                                    cipherparams: { iv: v3Params.iv.toString('hex') },\n                                    cipher: v3Params.cipher,\n                                    kdf: v3Params.kdf,\n                                    kdfparams: __assign(__assign({}, kdfParams), { salt: kdfParams.salt.toString('hex') }),\n                                    mac: mac.toString('hex'),\n                                },\n                            }];\n                }\n            });\n        });\n    };\n    /**\n     * Return the suggested filename for V3 keystores.\n     */\n    Wallet.prototype.getV3Filename = function (timestamp) {\n        /*\n         * We want a timestamp like 2016-03-15T17-11-33.007598288Z. Date formatting\n         * is a pain in Javascript, everbody knows that. We could use moment.js,\n         * but decide to do it manually in order to save space.\n         *\n         * toJSON() returns a pretty close version, so let's use it. It is not UTC though,\n         * but does it really matter?\n         *\n         * Alternative manual way with padding and Date fields: http://stackoverflow.com/a/7244288/4964819\n         *\n         */\n        var ts = timestamp ? new Date(timestamp) : new Date();\n        return ['UTC--', ts.toJSON().replace(/:/g, '-'), '--', this.getAddress().toString('hex')].join('');\n    };\n    Wallet.prototype.toV3String = function (password, opts) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, _b;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        _b = (_a = JSON).stringify;\n                        return [4 /*yield*/, this.toV3(password, opts)];\n                    case 1: return [2 /*return*/, _b.apply(_a, [_c.sent()])];\n                }\n            });\n        });\n    };\n    return Wallet;\n}());\nexports.default = Wallet;\n// helpers\nfunction runCipherBuffer(cipher, data) {\n    return Buffer.concat([cipher.update(data), cipher.final()]);\n}\nfunction keyExists(k) {\n    return k !== undefined && k !== null;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}